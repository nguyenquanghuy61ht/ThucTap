{"ast":null,"code":"import _classCallCheck from \"D:\\\\Thuctap\\\\client-app-v3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:\\\\Thuctap\\\\client-app-v3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _inherits from \"D:\\\\Thuctap\\\\client-app-v3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"D:\\\\Thuctap\\\\client-app-v3\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"D:\\\\Thuctap\\\\client-app-v3\\\\src\\\\app\\\\auth\\\\AuthGuard.jsx\";\nimport React, { Component, Fragment } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport AppContext from \"app/appContext\";\nimport ConstantList from \"../appConfig\";\n\nvar AuthGuard = /*#__PURE__*/function (_Component) {\n  _inherits(AuthGuard, _Component);\n\n  var _super = _createSuper(AuthGuard);\n\n  function AuthGuard(props, context) {\n    var _this;\n\n    _classCallCheck(this, AuthGuard);\n\n    _this = _super.call(this, props);\n    var routes = context.routes;\n    _this.state = {\n      authenticated: true,\n      routes: routes\n    };\n    return _this;\n  }\n\n  _createClass(AuthGuard, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {// if (!this.state.authenticated) {\n      //   this.redirectRoute(this.props);\n      // }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {// if (!this.state.authenticated) {\n      //   this.redirectRoute(this.props);\n      // }\n    }\n  }, {\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps, nextState) {// return nextState.authenticated !== this.state.authenticated;\n    }\n  }, {\n    key: \"redirectRoute\",\n    value: function redirectRoute(props) {\n      var location = props.location,\n          history = props.history;\n      var pathname = location.pathname;\n      history.push({\n        //pathname: ConstantList.ROOT_PATH + \"session/signin\",\n        pathname: ConstantList.HOME_PAGE,\n        state: {\n          redirectUrl: pathname\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var children = this.props.children; // const { authenticated } = this.state;\n\n      return /*#__PURE__*/React.createElement(Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 13\n        }\n      }, children); //return authenticated ? <Fragment>{children}</Fragment> : null;\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, state) {\n      var location = props.location,\n          user = props.user;\n      var pathname = location.pathname;\n      var matched = state.routes.find(function (r) {\n        return r.path === pathname;\n      });\n      var authenticated = matched && matched.auth && matched.auth.length ? matched.auth.includes(user.role) : true;\n      return {\n        authenticated: authenticated\n      };\n    }\n  }]);\n\n  return AuthGuard;\n}(Component);\n\nAuthGuard.contextType = AppContext;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.user\n  };\n};\n\nexport default withRouter(connect(mapStateToProps)(AuthGuard));","map":{"version":3,"names":["React","Component","Fragment","withRouter","connect","AppContext","ConstantList","AuthGuard","props","context","routes","state","authenticated","nextProps","nextState","location","history","pathname","push","HOME_PAGE","redirectUrl","children","user","matched","find","r","path","auth","length","includes","role","contextType","mapStateToProps"],"sources":["D:/Thuctap/client-app-v3/src/app/auth/AuthGuard.jsx"],"sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport AppContext from \"app/appContext\";\nimport ConstantList from \"../appConfig\";\nclass AuthGuard extends Component {\n  constructor(props, context) {\n    super(props);\n    let { routes } = context;\n\n    this.state = {\n      authenticated: true,\n      routes\n    };\n  }\n\n  componentDidMount() {\n    // if (!this.state.authenticated) {\n    //   this.redirectRoute(this.props);\n    // }\n  }\n\n  componentDidUpdate() {\n    // if (!this.state.authenticated) {\n    //   this.redirectRoute(this.props);\n    // }\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    // return nextState.authenticated !== this.state.authenticated;\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    const { location, user } = props;\n    const { pathname } = location;\n    const matched = state.routes.find(r => r.path === pathname);\n    const authenticated =\n      matched && matched.auth && matched.auth.length\n        ? matched.auth.includes(user.role)\n        : true;\n\n    return {\n      authenticated\n    };\n  }\n\n  redirectRoute(props) {\n    const { location, history } = props;\n    const { pathname } = location;\n\n    history.push({\n      //pathname: ConstantList.ROOT_PATH + \"session/signin\",\n      pathname: ConstantList.HOME_PAGE,\n      state: { redirectUrl: pathname }\n    });\n  }\n\n  render() {\n    let { children } = this.props;\n    // const { authenticated } = this.state;\n\n     return <Fragment>{children}</Fragment>;\n\n    //return authenticated ? <Fragment>{children}</Fragment> : null;\n  }\n}\n\nAuthGuard.contextType = AppContext;\n\nconst mapStateToProps = state => ({\n  user: state.user\n});\n\nexport default withRouter(connect(mapStateToProps)(AuthGuard));\n"],"mappings":";;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,UAAP,MAAuB,gBAAvB;AACA,OAAOC,YAAP,MAAyB,cAAzB;;IACMC,S;;;;;EACJ,mBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;IAAA;;IAAA;;IAC1B,0BAAMD,KAAN;IACA,IAAME,MAAN,GAAiBD,OAAjB,CAAMC,MAAN;IAEA,MAAKC,KAAL,GAAa;MACXC,aAAa,EAAE,IADJ;MAEXF,MAAM,EAANA;IAFW,CAAb;IAJ0B;EAQ3B;;;;WAED,6BAAoB,CAClB;MACA;MACA;IACD;;;WAED,8BAAqB,CACnB;MACA;MACA;IACD;;;WAED,+BAAsBG,SAAtB,EAAiCC,SAAjC,EAA4C,CAC1C;IACD;;;WAgBD,uBAAcN,KAAd,EAAqB;MACnB,IAAQO,QAAR,GAA8BP,KAA9B,CAAQO,QAAR;MAAA,IAAkBC,OAAlB,GAA8BR,KAA9B,CAAkBQ,OAAlB;MACA,IAAQC,QAAR,GAAqBF,QAArB,CAAQE,QAAR;MAEAD,OAAO,CAACE,IAAR,CAAa;QACX;QACAD,QAAQ,EAAEX,YAAY,CAACa,SAFZ;QAGXR,KAAK,EAAE;UAAES,WAAW,EAAEH;QAAf;MAHI,CAAb;IAKD;;;WAED,kBAAS;MACP,IAAMI,QAAN,GAAmB,KAAKb,KAAxB,CAAMa,QAAN,CADO,CAEP;;MAEC,oBAAO,oBAAC,QAAD;QAAA;QAAA;UAAA;UAAA;UAAA;QAAA;MAAA,GAAWA,QAAX,CAAP,CAJM,CAMP;IACD;;;WAhCD,kCAAgCb,KAAhC,EAAuCG,KAAvC,EAA8C;MAC5C,IAAQI,QAAR,GAA2BP,KAA3B,CAAQO,QAAR;MAAA,IAAkBO,IAAlB,GAA2Bd,KAA3B,CAAkBc,IAAlB;MACA,IAAQL,QAAR,GAAqBF,QAArB,CAAQE,QAAR;MACA,IAAMM,OAAO,GAAGZ,KAAK,CAACD,MAAN,CAAac,IAAb,CAAkB,UAAAC,CAAC;QAAA,OAAIA,CAAC,CAACC,IAAF,KAAWT,QAAf;MAAA,CAAnB,CAAhB;MACA,IAAML,aAAa,GACjBW,OAAO,IAAIA,OAAO,CAACI,IAAnB,IAA2BJ,OAAO,CAACI,IAAR,CAAaC,MAAxC,GACIL,OAAO,CAACI,IAAR,CAAaE,QAAb,CAAsBP,IAAI,CAACQ,IAA3B,CADJ,GAEI,IAHN;MAKA,OAAO;QACLlB,aAAa,EAAbA;MADK,CAAP;IAGD;;;;EAvCqBX,S;;AA8DxBM,SAAS,CAACwB,WAAV,GAAwB1B,UAAxB;;AAEA,IAAM2B,eAAe,GAAG,SAAlBA,eAAkB,CAAArB,KAAK;EAAA,OAAK;IAChCW,IAAI,EAAEX,KAAK,CAACW;EADoB,CAAL;AAAA,CAA7B;;AAIA,eAAenB,UAAU,CAACC,OAAO,CAAC4B,eAAD,CAAP,CAAyBzB,SAAzB,CAAD,CAAzB"},"metadata":{},"sourceType":"module"}